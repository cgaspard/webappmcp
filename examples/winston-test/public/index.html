<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Winston Logger Test</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            background: #0056b3;
        }
        .log-output {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin-top: 20px;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 400px;
            overflow-y: auto;
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .status.connected {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.disconnected {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <h1>Winston Logger Test</h1>
    <p>This page tests Winston logger integration with WebApp MCP server.</p>
    
    <div id="connection-status" class="status disconnected">
        WebSocket: Disconnected
    </div>
    
    <h2>Actions</h2>
    <button onclick="generateLogs()">Generate Winston Logs</button>
    <button onclick="generateClientLogs()">Generate Client Console Logs</button>
    <button onclick="clearLogs()">Clear Display</button>
    
    <h2>Server Response</h2>
    <div id="response" class="log-output">No logs generated yet...</div>
    
    <h2>Client Console Logs</h2>
    <div id="client-logs" class="log-output">No client logs yet...</div>
    
    <script src="/webappmcp-client.js"></script>
    <script>
        // Initialize WebApp MCP Client
        const client = new WebAppMCPClient({
            serverUrl: 'ws://localhost:4840',
            authToken: 'test-winston-token',
            debug: true
        });
        
        client.on('connected', () => {
            document.getElementById('connection-status').className = 'status connected';
            document.getElementById('connection-status').textContent = 'WebSocket: Connected';
            console.log('MCP Client connected successfully');
        });
        
        client.on('disconnected', () => {
            document.getElementById('connection-status').className = 'status disconnected';
            document.getElementById('connection-status').textContent = 'WebSocket: Disconnected';
            console.log('MCP Client disconnected');
        });
        
        client.connect();
        
        async function generateLogs() {
            try {
                const response = await fetch('/test-logs');
                const data = await response.json();
                
                document.getElementById('response').textContent = 
                    'Server logs generated at: ' + data.timestamp + '\n\n' +
                    'The following logs were sent to Winston:\n' +
                    '- ERROR: Test error message\n' +
                    '- WARN: Test warning message\n' +
                    '- INFO: Test info message\n' +
                    '- DEBUG: Test debug message\n\n' +
                    'And to console:\n' +
                    '- LOG: Regular console.log message\n' +
                    '- ERROR: Regular console.error message\n\n' +
                    'Check the MCP server logs to verify capture!';
            } catch (error) {
                document.getElementById('response').textContent = 'Error: ' + error.message;
            }
        }
        
        function generateClientLogs() {
            const timestamp = new Date().toISOString();
            
            // Generate various client-side logs
            console.log('Client LOG:', timestamp, '- Test log message');
            console.info('Client INFO:', timestamp, '- Test info message');
            console.warn('Client WARN:', timestamp, '- Test warning message');
            console.error('Client ERROR:', timestamp, '- Test error message');
            
            // Update display
            const logs = [
                'Client logs generated at: ' + timestamp,
                '',
                'LOG: Test log message',
                'INFO: Test info message',
                'WARN: Test warning message',
                'ERROR: Test error message'
            ].join('\n');
            
            document.getElementById('client-logs').textContent = logs;
        }
        
        function clearLogs() {
            document.getElementById('response').textContent = 'No logs generated yet...';
            document.getElementById('client-logs').textContent = 'No client logs yet...';
        }
    </script>
</body>
</html>